# Knit Out 项目分析文档

## 1. 项目技术栈

- Next.js 14.2.15
- React 18
- TypeScript
- TailwindCSS
- next-intl（国际化）
- next-sitemap（SEO）

## 2. 项目结构分析

### 2.1 核心目录

```
├── app/                    # Next.js 应用主目录
│   └── (default)/         # 默认路由组
├── components/            # React 组件
├── dictionaries/          # 多语言翻译文件
├── public/               # 静态资源
├── blog/                 # 博客文章内容
└── types/               # TypeScript 类型定义
```

### 2.2 需要清理的目录

- `stripe/` - 支付相关，不需要
- `prisma/` - 数据库相关，可能不需要
- `prompt-library/` - 原项目相关，不需要
- `context/` - 需要评估是否保留

## 3. 国际化实现

### 3.1 当前配置

- 使用 next-intl 实现
- 支持 5 种语言（en, cn, tw, ja, ko）
- 默认语言为英语（en）

### 3.2 需要修改

1. 精简语言支持，只保留：
   - 英语（en）
   - 简体中文（cn）
   - 繁体中文（tw）
   - 日语（ja）
   - 韩语（ko）
2. 修改文件：
   - `i18n.ts`
   - 清理 `dictionaries` 目录下不需要的语言文件
   - 更新 `middleware.ts` 的语言处理逻辑

## 4. 路由结构调整

### 4.1 需要实现的路由

- `/` - 首页
- `/level` - 关卡列表
- `/level/[id]` - 关卡详情
- `/blog` - 博客文章列表
- `/app` - 下载页面

### 4.2 修改建议

1. 在 `app` 目录下创建对应的路由目录
2. 删除不需要的路由
3. 更新 `next-sitemap.config.js` 配置

## 5. 组件改造

### 5.1 需要保留的组件

- 导航组件
- 搜索组件
- 语言切换组件
- 文章列表组件
- 分享组件

### 5.2 需要新增的组件

- 关卡列表组件
- 关卡详情组件
- 游戏下载引导组件

## 6. SEO 优化

### 6.1 现有配置

- 使用 next-sitemap 生成站点地图
- 已配置基本的 meta 信息

### 6.2 需要优化

1. 更新 `next-sitemap.config.js` 的配置
2. 完善每个页面的 meta 信息
3. 添加结构化数据
4. 优化图片 alt 文本

## 7. 性能优化

### 7.1 已有优化

- TailwindCSS 优化
- 图片懒加载
- 组件按需加载

### 7.2 建议优化

1. 静态页面生成（SSG）
2. 图片优化
3. 字体优化
4. 第三方脚本优化

## 8. 后续步骤

1. 清理不需要的依赖和文件
2. 实现核心路由和组件
3. 完善国际化内容
4. 优化 SEO 配置
5. 部署和性能测试

## 9. 注意事项

1. 保持项目结构清晰
2. 确保代码复用性
3. 维护良好的文档
4. 关注性能指标
5. 保证跨平台兼容性

## 10. 代码修改步骤规划

### 第一阶段：基础框架调整

1. **国际化配置调整**

   - 修改 `i18n.ts`，只保留 en 和 cn
   - 确保 `dictionaries` 中英文内容的完整性
   - 调整语言切换组件逻辑

2. **路由结构搭建**
   ```
   app/
   ├── [locale]/
   │   ├── page.tsx            # 首页
   │   ├── level/
   │   │   ├── page.tsx       # 关卡列表
   │   │   └── [id]/
   │   │       └── page.tsx   # 关卡详情
   │   ├── blog/              # 复用现有博客功能
   │   └── app/
   │       └── page.tsx       # 下载页面
   ```

### 第二阶段：页面开发

1. **首页（page.tsx）**

   - 实现页面布局
   - 集成关卡搜索功能
   - 展示热门关卡
   - 展示最新博客（复用现有组件）
   - 所需组件：
     - LevelSearchInput（关卡搜索输入框）
     - PopularLevels（热门关卡展示）

2. **关卡列表页（level/page.tsx）**

   - 实现关卡列表展示
   - 集成搜索和筛选功能
   - 所需组件：
     - LevelList（关卡列表容器）
     - LevelCard（关卡信息卡片）
     - LevelFilter（关卡筛选器）

3. **关卡详情页（level/[id]/page.tsx）**

   - 展示关卡详细信息
   - 实现攻略内容展示
   - 所需组件：
     - LevelDetail（关卡详情展示）
     - LevelGuide（攻略内容）
     - ShareButton（分享按钮，复用现有）

4. **下载页（app/page.tsx）**
   - 展示游戏介绍
   - 提供下载链接
   - 展示游戏截图
   - 所需组件：
     - GameIntro（游戏介绍）
     - DownloadButtons（下载按钮组）
     - GameScreenshots（游戏截图展示）

### 第三阶段：优化和测试

1. **SEO 配置**

   - 配置每个页面的 meta 信息
   - 实现动态 title 和 description
   - 添加结构化数据

2. **性能优化**

   - 实现静态页面生成
   - 图片优化处理
   - 组件懒加载配置

3. **测试和调整**
   - 功能测试（路由、语言切换、搜索、分享）
   - 兼容性测试（移动端、跨浏览器）
   - 内容审查（中英文内容、图片、链接）

### 开发顺序

1. 调整国际化配置
2. 创建路由结构
3. 开发首页
4. 开发关卡列表和详情页
5. 开发下载页
6. 进行优化和测试

### 注意事项

1. **复用现有功能**

   - 使用现有的布局组件（Layout）
   - 使用现有的导航组件（Navbar）
   - 使用现有的博客相关组件
   - 使用现有的语言切换组件

2. **开发重点**

   - 关注关卡功能的完整实现
   - 确保中英文内容的准确性
   - 保证页面响应式设计

3. **暂不处理**
   - 其他语言支持
   - 不必要的依赖清理
   - 额外的功能优化

预计总工期：约 12 个工作日（不包含内容编写时间）

## 11. 关卡系统设计

### 11.1 关卡数据结构

```typescript
interface LevelData {
  id: number; // 关卡ID
  title: string; // 关卡标题
  description: string; // 关卡描述
  timeLimit: number; // 时间限制（秒）
  items: Array<{
    // 物品列表
    id: string;
    name: string;
    type: string; // 物品类型（装饰品、家具等）
    position: {
      // 目标位置
      x: number;
      y: number;
    };
  }>;
}
```

### 11.2 关卡列表页面（/level）

#### 功能特点

1. 关卡筛选

   - 按难度筛选（简单/中等/困难）
   - 按房间类型筛选（卧室/客厅/书房等）
   - 按完成状态筛选（已完成/未完成）

2. 关卡展示

   - 网格布局展示关卡卡片
   - 每个卡片显示：
     - 天数范围
     - 缩略图
     - 视频标题
     - 观看次数（可选）

3. 搜索功能

   - 按天数搜索
   - 按关键词搜索
   - 支持模糊匹配

4. 分页功能
   - 每页显示 12 个关卡
   - 支持无限滚动加载

### 11.3 关卡详情页面（/level/[id]）

#### 页面组成

1. 视频区域

   - 嵌入 YouTube 播放器
   - 支持全屏播放
   - 显示视频标题和描述

2. 关卡信息

   - 天数范围
   - 游戏进度指示
   - 难度评估（可选）

3. 导航功能

   - 上一关/下一关快速切换
   - 返回列表按钮
   - 分享按钮

4. 相关推荐
   - 显示相近天数的关卡
   - 推荐同难度的其他关卡

### 11.4 数据管理

1. 状态管理

   - 使用 Redux Toolkit 管理关卡数据
   - 实现数据持久化
   - 支持离线访问

2. 数据缓存
   - 缓存已加载的关卡数据
   - 预加载相邻关卡
   - 优化页面切换体验

## 12. 下载页面设计（/app）

### 12.1 下载链接

```typescript
const DOWNLOAD_LINKS = {
  android:
    "https://play.google.com/store/apps/details?id=com.hyperup.holepeople",
  ios: "即将上线",
};
```

### 12.2 页面布局

1. 头部区域

   - 游戏 Logo
   - "Knit Out"
   - "一个温馨治愈的收纳整理游戏"
   - 评分（4.8 分）和下载量（1M+）

2. 游戏特色

   - 轻松解压：完美融合正念与创造力，为您提供一个远离日常喧嚣的平静港湾
   - 温馨故事：每个物品都讲述着生活的故事，通过物品展现温暖人心的生活点滴
   - 舒适氛围：柔和的视觉效果，平静的音乐，没有时间压力
   - 整理乐趣：将每件物品放在完美的位置，创造令人心安的空间
   - 情感共鸣：从童年卧室到第一个公寓，每个房间都唤起共同的回忆与情感
   - 独特玩法：简单直观又富有魅力的游戏体验

3. 社区链接
   - 开发者邮箱：hieplm@abigames.com.vn
   - 官方网站链接
   - 社交媒体链接

### 12.3 功能实现

1. 平台检测

   ```typescript
   const detectPlatform = () => {
     const userAgent = navigator.userAgent.toLowerCase();
     if (/android/.test(userAgent)) return "android";
     if (/iphone|ipad|ipod/.test(userAgent)) return "ios";
     return "unknown";
   };
   ```

2. 下载追踪

   - 记录下载来源
   - 统计转化率
   - A/B 测试支持

3. SEO 优化
   - 添加应用结构化数据
   - 优化 meta 标签
   - 支持应用深度链接

## 13. 注意事项

1. 保持项目结构清晰
2. 确保代码复用性
3. 维护良好的文档
4. 关注性能指标
5. 保证跨平台兼容性

预计总工期：约 12 个工作日（不包含内容编写时间）
